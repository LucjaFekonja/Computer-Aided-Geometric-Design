f = @(x, y) 0.75 * exp(-((9*x-2)^2 + (9*y-2)^2)/4) + ...
            0.75 * exp(-(9*x+1)^2 / 49 - (9*y+1)/10) + ...
            0.5 * exp(-((9*x-7)^2 + (9*y-3)^2)/4) - ...
            0.2 * exp(-(9*x-4)^2 - (9*y-7)^2);

dxf = @(x,y) - 0.75 * 9 * (9*x-2) * exp(-((9*x-2)^2 + (9*y-2)^2)/4) / 2 - ...
             0.75 * 18 * (9*x+1) * exp(-(9*x+1)^2 / 49 - (9*y+1)/10) / 49 - ...
             0.5 * 9 * (9*x-7) * exp(-((9*x-7)^2 + (9*y-3)^2)/4) / 2 + ...
             0.2 * 18 * (9*x-4) * exp(-(9*x-4)^2 - (9*y-7)^2);

dyf = @(x,y) - 0.75 * 9 * (9*y-2) * exp(-((9*x-2)^2 + (9*y-2)^2)/4) / 2 - ...
             0.75 * 9 * (9*y+1) * exp(-(9*x+1)^2 / 49 - (9*y+1)/10) / 10 - ...
             0.5 * 9 * (9*y-3) * exp(-((9*x-7)^2 + (9*y-3)^2)/4) / 2 + ...
             0.2 * 18 * (9*y-7) * exp(-(9*x-4)^2 - (9*y-7)^2);

X = [0 0.5 1 0.15 0.7 0.5 0.25 0.4 0.75 0.85 0.55 0 0.2 0.45 0.6 0.25 0.4 ...
     0.65 0.8 0.85 1 1 0.5 0.1 0 0.25 0.75 0.25 0 0.75 0 1 1 0.19 0.32 0.79];

Y = [0 0 0 0.15 0.15 0.2 0.3 0.3 0.4 0.25 0.45 0.5 0.45 0.55 0.65 0.7 0.8 ...
    0.75 0.85 0.65 0.5 1 1 0.85 1 0 0 1 0.25 1 0.75 0.25 0.75 0.19 0.75 0.46];


TRI = delaunay(X', Y');
tri = triangulation(TRI, X', Y');


% Meshgrid
[max_error, mean_error] = plot_spline(tri, f, dxf, dyf, 25)

% Trimeshgrid
figure
[max_error_tri, mean_error_tri] = plot_spline_tri(tri, f, dxf, dyf, 3)

