f = @(x,y) 3*(1-x).^2.*exp(-x.^2 - (y+1).^2) ...
- 10*(x/5 - x.^3 - y.^5).*exp(-x.^2-y.^2) ...
- 1/3*exp(-(x+1).^2 - y.^2);

dxf = @(x,y) (exp(-(x + 1)^2 - y^2)*(2*x + 2))/3 ...
+ 3*exp(- (y + 1)^2 - x^2)*(2*x - 2) ...
+ exp(- x^2 - y^2)*(30*x^2 - 2) ...
- 6*x*exp(- (y + 1)^2 - x^2)*(x - 1)^2 ...
- 2*x*exp(- x^2 - y^2)*(10*x^3 - 2*x + 10*y^5);

dyf = @(x,y) (2*y*exp(- (x + 1)^2 - y^2))/3 ...
+ 50*y^4*exp(- x^2 - y^2) ...
- 3*exp(- (y + 1)^2 - x^2)*(2*y + 2)*(x - 1)^2 ...
- 2*y*exp(- x^2 - y^2)*(10*x^3 - 2*x + 10*y^5);

X = [-3.0; -3.0; -3.0; -3.0; -1.7; -1.6; -1.5; -1.1; -0.9; ...
-0.7; -0.5; -0.5; -0.5; -0.4; 0.0; 0.5; 0.5; 0.6; 0.7; ...
1.0; 1.2; 1.2; 1.6; 2.0; 2.0; 3.0; 3.0; 3.0; 3.0; 3.0];
Y = [-3.0; -2.0; 1.0; 3.0; -1.0; 0.5; 1.7; -3.0; -2.0; 1.0; ...
-1.0; 0.0; 3.0; 1.6; -2.0; -1.0; 0.5; 1.2; -0.4; 2.2; ...
-3.0; -1.6; 3.0; -1.0; 0.6; -3.0; -1.8; -0.4; 1.7; 3.0];

TRI = delaunay(X,Y);
tri = triangulation(TRI,X,Y);

% Meshgrid
[max_error1, mean_error1] = plot_spline(tri, f, dxf, dyf, 50)


% Trimeshgrid
figure
[max_error2, mean_error2] = plot_spline_tri(tri, f, dxf, dyf, 6)
