f = @(x,y) (1.25 + cos(5.4 * y)) / (6 + 6 * (3 * x - 1)^2);
dxf = @(x,y) - 36 * (3 * x - 1) * (1.25 + cos(5.4 * y)) / (6 + 6 * (3 * x - 1)^2)^2;
dyf = @(x,y) - 5.4 * sin(5.4 * y) / (6 + 6 * (3 * x - 1)^2);


% ---------------------------------------------------------------------------
% SPECIFIC POINTS

X = [0 0.5 1 0.15 0.7 0.5 0.25 0.4 0.75 0.85 0.55 0 0.2 0.45 0.6 0.25 0.4 ...
     0.65 0.8 0.85 1 1 0.5 0.1 0 0.25 0.75 0.25 0 0.75 0 1 1 0.19 0.32 0.79];

Y = [0 0 0 0.15 0.15 0.2 0.3 0.3 0.4 0.25 0.45 0.5 0.45 0.55 0.65 0.7 0.8 ...
    0.75 0.85 0.65 0.5 1 1 0.85 1 0 0 1 0.25 1 0.75 0.25 0.75 0.19 0.75 0.46];

% TRI_CUSTOM = [11 15 14; 14 8 11; 15 9 36; 11 6 9; 6 11 8; 14 16 13; 14 7 8; 
%               8 26 6; 15 20 18; 14 17 35; 9 15 11; 17 14 15; 7 14 13; 16 14 35; 17 15 18;
%               20 15 36; 6 5 9; 9 10 36; 36 21 20; 7 29 34; 34 8 7; 6 2 5; 10 9 5; 18 23 17; 
%               20 19 18; 34 29 4; 6 26 2, 16 12 13; 29 7 13; 26 8 34; 5 27 10; 
%               18 30 23; 35 28 24; 35 24 16; 16 31 12; 21 36 10; 20 33 19; 28 35 17; 29 13 12; 
%               4 1 26; 26 34 4; 31 16 24; 27 5 2; 10 32 21; 28 17 23;
%               10 3 32; 19 22 30; 30 18 19; 33 20 21; 1 4 29; 28 25 24; 24 25 31; 3 10 27; 22 19 33];


% Na≈°a triangulacija
% tri_custom = triangulation(TRI_CUSTOM, X', Y');
% triplot(tri_custom);
% plot_spline(tri_custom, f, dxf, dyf, 25);


TRI = delaunay(X', Y');
tri = triangulation(TRI, X', Y');

[max_error, mean_error] = plot_spline(tri, f, dxf, dyf, 25)


% ------------------------------------------------------------------------

% RANDOM POINTS

X_rand = [0 0 1 1 rand(1, 32)]';
Y_rand = [0 1 0 1 rand(1, 32)]';

TRI_rand = delaunay(X_rand,Y_rand);
tri_rand = triangulation(TRI_rand,X_rand,Y_rand);

figure
[max_error_rand, mean_error_rand] = plot_spline(tri_rand, f, dxf, dyf, 25)
